<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>fcfutils.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#define-members">Defines</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">fcfutils.h File Reference</div>  </div>
</div>
<div class="contents">

<p>Utility functions for the flight control framework (fcf)  
<a href="#details">More...</a></p>

<p><a href="fcfutils_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa8cecfc5c5c054d2875c03e77b7be15d"></a><!-- doxytag: member="fcfutils.h::TRUE" ref="aa8cecfc5c5c054d2875c03e77b7be15d" args="" -->
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TRUE</b>&#160;&#160;&#160;1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa93f0eb578d23995850d61f7d61c55c1"></a><!-- doxytag: member="fcfutils.h::FALSE" ref="aa93f0eb578d23995850d61f7d61c55c1" args="" -->
#define&#160;</td><td class="memItemRight" valign="bottom"><b>FALSE</b>&#160;&#160;&#160;0</td></tr>
<tr><td colspan="2"><h2><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a085e004910088ee71278a46a35412ace"></a><!-- doxytag: member="fcfutils.h::pollfd_callback" ref="a085e004910088ee71278a46a35412ace" args=")(int fd_idx)" -->
typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><b>pollfd_callback</b> )(int fd_idx)</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fcfutils_8h.html#ab1c2e77eeb4a4d58cfb59782121e4000">init_fcf</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">initialization for fcf data structures  <a href="#ab1c2e77eeb4a4d58cfb59782121e4000"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fcfutils_8h.html#aa1c613165266b69a81f7d9e229e57e94">expand_arrays</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">increases the size of the file descriptor and file description arrays  <a href="#aa1c613165266b69a81f7d9e229e57e94"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fcfutils_8h.html#a88f56229ca750186a10dac8acd21a377">fcf_add_fd</a> (const char *, int, short, pollfd_callback)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">adds file descriptor on tot he end of the array  <a href="#a88f56229ca750186a10dac8acd21a377"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fcfutils_8h.html#a5fba8f3e4edbb0354e91dc9cbe03ab22">fcf_remove_fd</a> (int)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">simply removes a specified file descriptor from the arrays  <a href="#a5fba8f3e4edbb0354e91dc9cbe03ab22"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3383c0f32d995e885927403b8929e301"></a><!-- doxytag: member="fcfutils.h::fcf_remove_fd_by_token" ref="a3383c0f32d995e885927403b8929e301" args="(const char *)" -->
int&#160;</td><td class="memItemRight" valign="bottom"><b>fcf_remove_fd_by_token</b> (const char *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab5640c6af61c24e64256af0ca9f8c5eb"></a><!-- doxytag: member="fcfutils.h::fcf_get_fd" ref="ab5640c6af61c24e64256af0ca9f8c5eb" args="(int)" -->
struct pollfd *&#160;</td><td class="memItemRight" valign="bottom"><b>fcf_get_fd</b> (int)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a306ae811903f12763eaa665b26a3520f"></a><!-- doxytag: member="fcfutils.h::fcf_stop_main_loop" ref="a306ae811903f12763eaa665b26a3520f" args="(void)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fcfutils_8h.html#a306ae811903f12763eaa665b26a3520f">fcf_stop_main_loop</a> (void)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">stops main loop by setting run_fc to 0 <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aef6369ee97564b38c70b56152312f60d"></a><!-- doxytag: member="fcfutils.h::fcf_start_main_loop" ref="aef6369ee97564b38c70b56152312f60d" args="(void)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fcfutils_8h.html#aef6369ee97564b38c70b56152312f60d">fcf_start_main_loop</a> (void)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">starts main loop by setting run_fc to 1 <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fcfutils_8h.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> (int argc, char *argv[])</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Main function for framework.  <a href="#a0ddf1224851353fc92bfbff6f499fa97"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fcfutils_8h.html#a5fe868afcf5451e49c4b7bcd4ea40d46">fcf_run_poll_loop</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">polls file descriptors for changes.  <a href="#a5fe868afcf5451e49c4b7bcd4ea40d46"></a><br/></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Utility functions for the flight control framework (fcf) </p>
<p>The core framework file, it starts in the main function, introducing the rogram. This program has signal handlers for when the user exits abrubtly using ctrl+Z, allowing a graceful shutdown of the software. The main function also initializes the framework and the modules before running the main loop. Lastly, this file contains the struct that holds the callback functions and source tokens of each device.</p>
<p>Below are the variables for this <a href="file:">file:</a></p>
<p>static const char STANDARD = 0;//&lt; Standard callback<br/>
 static const char PPC = 1;//&lt; Per poll cycle callback<br/>
 static struct pollfd * fds;//&lt; File descriptor array<br/>
 static struct fcffd * fdx;//&lt; File description array<br/>
 static int nfds;//&lt; Number of file descriptors in arrays<br/>
 static int fd_array_size;//&lt; Allocated size of file descriptor array, fds<br/>
 static int run_fc;//&lt; Main loop is running true/false<br/>
</p>
<dl class="author"><dt><b>Author:</b></dt><dd>Team Elderberry </dd></dl>
<dl class="date"><dt><b>Date:</b></dt><dd>March 2nd, 2013 </dd></dl>
</div><hr/><h2>Function Documentation</h2>
<a class="anchor" id="aa1c613165266b69a81f7d9e229e57e94"></a><!-- doxytag: member="fcfutils.h::expand_arrays" ref="aa1c613165266b69a81f7d9e229e57e94" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int expand_arrays </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>increases the size of the file descriptor and file description arrays </p>
<p>Creates two temp structures for the new arrays. The new arrays size is doubled from the previous ones. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>-1 Error in realloc command for one of the new arrays </dd>
<dd>
0 successfully doubled array-size and copied over old information. </dd></dl>

</div>
</div>
<a class="anchor" id="a88f56229ca750186a10dac8acd21a377"></a><!-- doxytag: member="fcfutils.h::fcf_add_fd" ref="a88f56229ca750186a10dac8acd21a377" args="(const char *, int, short, pollfd_callback)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fcf_add_fd </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">short&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pollfd_callback&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>adds file descriptor on tot he end of the array </p>
<p>Checks to see if the file descriptor arrays are full. If the arrays are full it calls the <a class="el" href="fcfutils_8h.html#aa1c613165266b69a81f7d9e229e57e94" title="increases the size of the file descriptor and file description arrays">expand_arrays()</a> fucntion (this will double the size of the arrays). It adds information to two arrays, the fds and fdx arrays. The fds array has pollfd pointers (required by the poll system call) and the fdx array has fcffd pointers (required by our framework [containing callback functions and other information]) </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>index of the last fd </dd></dl>

</div>
</div>
<a class="anchor" id="a5fba8f3e4edbb0354e91dc9cbe03ab22"></a><!-- doxytag: member="fcfutils.h::fcf_remove_fd" ref="a5fba8f3e4edbb0354e91dc9cbe03ab22" args="(int)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fcf_remove_fd </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>simply removes a specified file descriptor from the arrays </p>
<p>If there are no fds in the array, the function errors out. If there are fd's in the arrays they are removed from both the fds and fdx arrays. </p>

</div>
</div>
<a class="anchor" id="a5fe868afcf5451e49c4b7bcd4ea40d46"></a><!-- doxytag: member="fcfutils.h::fcf_run_poll_loop" ref="a5fe868afcf5451e49c4b7bcd4ea40d46" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int fcf_run_poll_loop </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>polls file descriptors for changes. </p>
<p>While run_fc is 1 (controlled by fcf_stop_main_loop and fcf_start_main_loop). The poll function is a system call [poll(array_of_fds, number_of_fds, negative_int) the negative integer indicates no timeout, if timeout is desired we recommend using timerfds]. The loop performs error checking, cycles through the array of fds whos r-events have changed. We only loop through the arrays after a change has been detected. After a change is detected and identified, the fd's callback function is called. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>-1 ERROR </dd>
<dd>
0 upon success </dd></dl>

</div>
</div>
<a class="anchor" id="ab1c2e77eeb4a4d58cfb59782121e4000"></a><!-- doxytag: member="fcfutils.h::init_fcf" ref="ab1c2e77eeb4a4d58cfb59782121e4000" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int init_fcf </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>initialization for fcf data structures </p>
<p>Takes the global array size into a variable (this array size can be doubled when the array is full) Malloc commands create two arrays; fds and fdx. The fds array is an array of pollfd pointers(required by the poll function). The fdx array has fcffd pointers(containing other information including callback actions). The index of these two arrays are matched so the information is accurate and related. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>0</dd></dl>
<p>Initialization for fcf data structures </p>

</div>
</div>
<a class="anchor" id="a0ddf1224851353fc92bfbff6f499fa97"></a><!-- doxytag: member="fcfutils.h::main" ref="a0ddf1224851353fc92bfbff6f499fa97" args="(int argc, char *argv[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>argv</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Main function for framework. </p>
<p>Prints the licensing information, and software version number. It contains the signal handler for graceful shutdown should the user CTRL-C out of the program. It then initializes the framework and runns the polling loop. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>EXIT_SUCCESS </dd>
<dd>
EXIT_FAILURE </dd></dl>

</div>
</div>
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address class="footer"><small>Generated on Mon Mar 4 2013 19:00:55 by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
